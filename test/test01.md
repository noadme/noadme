사용자가 웹 애플리케이션에 로그인하고 인증된 상태에서 특정 기능을 요청하는 과정을 보여줍니다. 여기에는 사용자(User), 웹 애플리케이션(WEB), 인증 및 접근 관리 시스템(IAM, 예를 들어 Keycloak), API 백엔드(TB), 서비스 프로바이더(SP), 그리고 추가 서비스 프로바이더(CSP)와의 상호작용이 포함됩니다.

### 시퀀스 다이어그램 설명

1. **시스템 설정 단계 (로그인 없이)**
    - IAM 시스템이 TB(백엔드)에 Public Key를 제공합니다. 이 Public Key는 TB가 나중에 IAM으로부터 받은 토큰을 검증하는 데 사용됩니다.
    - IAM과 TB 사이의 이 설정은 사용자 로그인이 필요 없는 시스템 설정 단계입니다.

2. **사용자 로그인 단계**
    - 사용자가 웹 애플리케이션(WEB)에 로그인 요청을 합니다.
    - WEB은 사용자 인증을 위해 IAM에 사용자 유효성 검사를 요청합니다.
    - IAM은 사용자가 유효한지 검증하고, 유효한 사용자라면 WEB에 사용자 토큰을 반환합니다.
    - WEB은 이 사용자 토큰을 사용하여 사용자에게 세션을 제공합니다.
    - 사용자와 WEB 사이에서 세션이 유지됩니다.

3. **사용자의 기능 요청**
    - 사용자가 웹 애플리케이션(WEB)에 특정 기능을 요청합니다.
    - WEB은 이 요청을 처리하기 위해 사용자 토큰과 함께 TB에 API 호출을 합니다.
    - TB는 API 미들웨어를 통해 API 호출을 처리하고, IAM으로부터 받은 Public Key를 사용하여 사용자 토큰을 검증합니다.

4. **서비스 프로바이더와의 상호작용**
    - TB는 사용자 토큰을 포함한 API 호출을 서비스 프로바이더(SP)에 전달합니다.
    - SP도 API 미들웨어를 통해 API 호출을 처리하고, 동일한 Public Key를 사용하여 사용자 토큰을 검증합니다.
    - SP는 추가 서비스 프로바이더(CSP)에 API 호출을 전달합니다.
    - CSP는 요청을 처리하고 결과를 SP에 반환합니다.
    - SP는 결과를 TB에 반환하고, TB는 최종 결과를 WEB에 반환합니다.
    - WEB은 사용자에게 최종 결과를 반환합니다.

이 시퀀스 다이어그램은 복잡한 웹 애플리케이션에서의 인증 및 권한 부여 흐름을 시각적으로 설명합니다. 이를 통해 각 시스템이 어떻게 상호작용하며, 사용자 요청이 어떻게 처리되는지에 대한 전반적인 이해를 돕습니다.


내용을 분석해서 mermaid 다이어그램으로 만들어줘.
